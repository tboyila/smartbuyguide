<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SmartBuyGuide</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-gradient-to-br from-slate-50 to-blue-50">
  <!-- Header -->
  <header class="bg-white shadow-sm sticky top-0 z-50">
    <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16">
        <div class="flex items-center space-x-2">
          <div class="w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-lg flex items-center justify-center">
            <span class="text-white text-xl font-bold">S</span>
          </div>
          <span class="text-2xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent">
            SmartBuyGuide
          </span>
        </div>

        <!-- Desktop Navigation -->
        <div class="hidden md:flex items-center space-x-8">
          <a href="#home" class="text-gray-700 hover:text-blue-600 transition">Home</a>
          <a href="#features" class="text-gray-700 hover:text-blue-600 transition">Features</a>
          <a href="#about" class="text-gray-700 hover:text-blue-600 transition">About</a>
          <a href="#tiktok" class="text-gray-700 hover:text-blue-600 transition">TikTok Integration</a>
          <a href="/terms.html" class="text-gray-700 hover:text-blue-600 transition">Terms</a>
          <a href="/privacy.html" class="text-gray-700 hover:text-blue-600 transition">Privacy</a>
        </div>

        <!-- Mobile menu button (non-functional placeholder) -->
        <button class="md:hidden p-2" aria-label="Open menu">
          <span class="block w-6 h-0.5 bg-gray-800 mb-1"></span>
          <span class="block w-6 h-0.5 bg-gray-800 mb-1"></span>
          <span class="block w-6 h-0.5 bg-gray-800"></span>
        </button>
      </div>
    </nav>
  </header>

  <!-- Hero Section -->
  <section id="home" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20">
    <div class="text-center">
      <h1 class="text-5xl md:text-6xl font-bold text-gray-900 mb-6">
        Discover the Best Products
        <span class="block bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent">
          With Smart Recommendations
        </span>
      </h1>
      <p class="text-xl text-gray-600 mb-8 max-w-3xl mx-auto">
        SmartBuyGuide helps you compare and discover top-rated products with expert reviews,
        detailed comparisons, and personalized recommendations to make informed purchasing decisions.
      </p>
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <a href="#features" class="px-8 py-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-lg font-semibold hover:shadow-lg transition transform hover:scale-105 text-center">
          Get Started Free
        </a>
        <a href="#about" class="px-8 py-4 bg-white text-blue-600 rounded-lg font-semibold border-2 border-blue-600 hover:bg-blue-50 transition text-center">
          Learn More
        </a>
        <!-- Login with TikTok hero button -->
        <button
          type="button"
          onclick="loginWithTikTok()"
          class="px-8 py-4 bg-black text-white rounded-lg font-semibold hover:shadow-lg transition transform hover:scale-105 text-center inline-flex items-center justify-center gap-2"
        >
          <!-- Replace with official TikTok logo asset -->
          <img src="tiktok-logo.svg" alt="TikTok" class="w-5 h-5" />
          <span>Login with TikTok</span>
        </button>
      </div>

      <!-- Simple auth status -->
      <div class="mt-6 text-sm text-gray-600">
        <span id="tiktok-auth-status">Not logged in with TikTok.</span>
      </div>
    </div>
  </section>

  <!-- Features Section -->
  <section id="features" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20">
    <h2 class="text-4xl font-bold text-center mb-16 text-gray-900">
      Why Choose SmartBuyGuide?
    </h2>
    <div class="grid md:grid-cols-3 gap-8">
      <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transition">
        <div class="w-14 h-14 bg-blue-100 rounded-lg flex items-center justify-center mb-4">
          <span class="text-blue-600 text-2xl font-bold">S</span>
        </div>
        <h3 class="text-2xl font-bold mb-3 text-gray-900">Smart Search</h3>
        <p class="text-gray-600">
          Advanced filtering and search algorithms help you find exactly what you need from thousands of products.
        </p>
      </div>

      <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transition">
        <div class="w-14 h-14 bg-indigo-100 rounded-lg flex items-center justify-center mb-4">
          <span class="text-indigo-600 text-2xl font-bold">★</span>
        </div>
        <h3 class="text-2xl font-bold mb-3 text-gray-900">Expert Reviews</h3>
        <p class="text-gray-600">
          Comprehensive product reviews with detailed comparisons, pros and cons, and honest recommendations.
        </p>
      </div>

      <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transition">
        <div class="w-14 h-14 bg-purple-100 rounded-lg flex items-center justify-center mb-4">
          <span class="text-purple-600 text-2xl font-bold">₱</span>
        </div>
        <h3 class="text-2xl font-bold mb-3 text-gray-900">Price Tracking</h3>
        <p class="text-gray-600">
          Track price history and get alerts when products you're interested in go on sale.
        </p>
      </div>

      <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transition">
        <div class="w-14 h-14 bg-green-100 rounded-lg flex items-center justify-center mb-4">
          <span class="text-green-600 text-2xl font-bold">✔</span>
        </div>
        <h3 class="text-2xl font-bold mb-3 text-gray-900">Verified Sources</h3>
        <p class="text-gray-600">
          All product information comes from verified retailers and trusted affiliate partners.
        </p>
      </div>

      <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transition">
        <div class="w-14 h-14 bg-orange-100 rounded-lg flex items-center justify-center mb-4">
          <span class="text-orange-600 text-2xl font-bold">&gt;</span>
        </div>
        <h3 class="text-2xl font-bold mb-3 text-gray-900">Easy Comparison</h3>
        <p class="text-gray-600">
          Side-by-side product comparisons make it simple to evaluate features, prices, and specifications.
        </p>
      </div>

      <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transition">
        <div class="w-14 h-14 bg-pink-100 rounded-lg flex items-center justify-center mb-4">
          <span class="text-pink-600 text-2xl font-bold">★</span>
        </div>
        <h3 class="text-2xl font-bold mb-3 text-gray-900">Daily Updates</h3>
        <p class="text-gray-600">
          Fresh content daily with new product listings, reviews, and shopping guides.
        </p>
      </div>
    </div>
  </section>

  <!-- TikTok Integration Section -->
  <section id="tiktok" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20">
    <div class="bg-white rounded-2xl shadow-xl p-12">
      <h2 class="text-4xl font-bold text-center mb-8 text-gray-900">
        SmartBuyGuide TikTok Integration
      </h2>

      <!-- TikTok buttons demo -->
      <div class="max-w-3xl mx-auto mb-10">
        <div class="border border-gray-200 rounded-xl p-6 bg-gray-50">
          <p class="text-sm font-semibold text-gray-700 mb-4">
            TikTok Integration UI
          </p>
          <div class="flex flex-wrap gap-4">
            <!-- Login with TikTok -->
            <button
              type="button"
              onclick="loginWithTikTok()"
              class="px-4 py-2 bg-black text-white rounded-lg font-medium inline-flex items-center gap-2 shadow-sm hover:shadow-md transition"
            >
              <img src="tiktok-logo.svg" alt="TikTok" class="w-5 h-5" />
              <span>Login with TikTok</span>
            </button>

            <!-- Share to TikTok (opens modal) -->
            <button
              type="button"
              onclick="openShareModal()"
              class="px-4 py-2 bg-white text-gray-900 rounded-lg font-medium inline-flex items-center gap-2 border border-gray-300 shadow-sm hover:bg-gray-100 transition"
            >
              <img src="tiktok-logo.svg" alt="TikTok" class="w-5 h-5" />
              <span>Share to TikTok</span>
            </button>

            <!-- Post to TikTok (direct post mode) -->
            <button
              type="button"
              onclick="openShareModal('DIRECT_POST')"
              class="px-4 py-2 bg-gradient-to-r from-pink-500 via-red-500 to-yellow-500 text-white rounded-lg font-medium inline-flex items-center gap-2 shadow-sm hover:shadow-md transition"
            >
              <img src="tiktok-logo.svg" alt="TikTok" class="w-5 h-5" />
              <span>Post to TikTok</span>
            </button>
          </div>
          <p class="text-xs text-gray-500 mt-3">
            All TikTok actions are user-initiated and wired to TikTok Login Kit and the Content Posting API
            via the backend integration.
          </p>
        </div>
      </div>

      <div class="max-w-3xl mx-auto text-gray-600 space-y-6 text-lg">
        <p>
          SmartBuyGuide integrates TikTok Login Kit and the TikTok Content Posting API to enable seamless
          product sharing and secure user authentication.
        </p>

        <div>
          <h3 class="text-2xl font-semibold text-gray-900 mb-2">Login Kit Integration</h3>
          <p>
            Users can authenticate with their TikTok account by clicking the
            <strong>“Login with TikTok”</strong> button displayed on the homepage. This triggers TikTok’s
            OAuth 2.0 flow where users authorize SmartBuyGuide to access their basic profile information,
            including username, display name, and profile picture. After successful authorization, users
            are redirected back to SmartBuyGuide with an authenticated session, allowing access to
            personalized features and saved preferences.
          </p>
        </div>

        <div>
          <h3 class="text-2xl font-semibold text-gray-900 mb-2">Content Posting API Integration</h3>
          <p>
            On any product detail page, authenticated users can click the <strong>“Share to TikTok”</strong>
            button to create and publish product recommendations. This opens our content creation interface
            where users can customize their post by adding product images, writing review text, including
            captions, and selecting relevant hashtags. Users can preview the content before posting.
          </p>
          <p class="mt-3">
            When they click <strong>“Post to TikTok”</strong>, the Content Posting API publishes the content
            directly to their TikTok profile as a photo or video post with product details and affiliate
            information.
          </p>
        </div>

        <p>
          All integrations are user-initiated through clearly labeled UI elements with official TikTok
          branding. No content is posted automatically without explicit user consent and action. The complete
          flow is demonstrated using TikTok’s sandbox environment in the submitted demo video.
        </p>

        <!-- Show auth code for demo -->
        <div id="tiktok-auth-code-container" class="mt-6 hidden">
          <h3 class="text-xl font-semibold text-gray-900 mb-2">Authorization Code (Demo)</h3>
          <p class="text-sm text-gray-600 mb-2">
            For demo purposes, SmartBuyGuide displays the OAuth authorization code returned by TikTok. In production this
            is sent securely to the backend to exchange for an access token via the Content Posting API.
          </p>
          <code id="tiktok-auth-code" class="block text-xs bg-gray-100 rounded-md p-3 break-all"></code>
        </div>
      </div>
    </div>
  </section>

  <!-- About Section -->
  <section id="about" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20">
    <div class="bg-white rounded-2xl shadow-xl p-12">
      <h2 class="text-4xl font-bold text-center mb-8 text-gray-900">
        About SmartBuyGuide
      </h2>
      <div class="max-w-3xl mx-auto text-gray-600 space-y-4 text-lg">
        <p>
          SmartBuyGuide is your trusted companion for making informed purchasing decisions.
          We aggregate and analyze thousands of products from various categories to help you
          find the perfect match for your needs and budget.
        </p>
        <p>
          Our platform combines expert reviews, user feedback, price comparisons, and detailed
          product specifications to give you a complete picture before you buy. Whether you're
          shopping for electronics, home goods, fitness equipment, or anything in between,
          SmartBuyGuide has you covered.
        </p>
        <p>
          We partner with trusted retailers and affiliate networks to ensure you get access
          to genuine products at competitive prices, while our comprehensive guides help you
          understand what to look for in each product category.
        </p>
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20">
    <div class="bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl p-12 text-center text-white">
      <h2 class="text-4xl font-bold mb-4">Ready to Shop Smarter?</h2>
      <p class="text-xl mb-8 opacity-90">
        Join thousands of smart shoppers who make better buying decisions with SmartBuyGuide.
      </p>
      <a href="#home" class="px-8 py-4 bg-white text-blue-600 rounded-lg font-semibold hover:shadow-lg transition transform hover:scale-105 inline-block">
        Start Exploring Now
      </a>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-gray-900 text-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
      <div class="grid md:grid-cols-4 gap-8 mb-8">
        <div>
          <div class="flex items-center space-x-2 mb-4">
            <div class="w-8 h-8 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-lg flex items-center justify-center">
              <span class="text-white font-bold">S</span>
            </div>
            <span class="text-xl font-bold">SmartBuyGuide</span>
          </div>
          <p class="text-gray-400">
            Your trusted source for product comparisons and reviews.
          </p>
        </div>

        <div>
          <h4 class="font-semibold mb-4 text-lg">Company</h4>
          <ul class="space-y-2 text-gray-400">
            <li><a href="#about" class="hover:text-white transition">About Us</a></li>
            <li><a href="#contact" class="hover:text-white transition">Contact</a></li>
            <li><a href="#careers" class="hover:text-white transition">Careers</a></li>
          </ul>
        </div>

        <div>
          <h4 class="font-semibold mb-4 text-lg">Resources</h4>
          <ul class="space-y-2 text-gray-400">
            <li><a href="#blog" class="hover:text-white transition">Blog</a></li>
            <li><a href="#guides" class="hover:text-white transition">Buying Guides</a></li>
            <li><a href="#faq" class="hover:text-white transition">FAQ</a></li>
          </ul>
        </div>

        <div>
          <h4 class="font-semibold mb-4 text-lg">Legal</h4>
          <ul class="space-y-2 text-gray-400">
            <li><a href="/terms.html" class="hover:text-white transition">Terms of Service</a></li>
            <li><a href="/privacy.html" class="hover:text-white transition">Privacy Policy</a></li>
            <li><a href="#cookies" class="hover:text-white transition">Cookie Policy</a></li>
          </ul>
        </div>
      </div>

      <div class="border-t border-gray-800 pt-8 text-center text-gray-400">
        <p>&copy; 2024 SmartBuyGuide. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <!-- Share / Post Modal -->
  <div id="share-modal" class="fixed inset-0 bg-black/40 hidden items-center justify-center z-50">
    <div class="bg-white rounded-2xl max-w-lg w-full p-6 shadow-2xl">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-xl font-semibold text-gray-900" id="share-modal-title">
          Share Product to TikTok
        </h3>
        <button class="text-gray-500 hover:text-gray-800" onclick="closeShareModal()">&times;</button>
      </div>

      <form id="share-form" class="space-y-4" onsubmit="submitShareForm(event)">
        <input type="hidden" id="post-mode" name="postMode" value="DRAFT">

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Product Name</label>
          <input
            id="product-name"
            type="text"
            class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
            placeholder="Example: SmartBuyGuide Top Pick - Noise Cancelling Headphones"
            required
          />
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Media URL</label>
          <input
            id="media-url"
            type="url"
            class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
            placeholder="https://your-cdn.com/product-image.jpg"
            required
          />
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Caption</label>
          <textarea
            id="caption"
            rows="3"
            class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
            placeholder="Why you love this product, plus hashtags like #SmartBuyGuide #TikTokMadeMeBuyIt"
            required
          ></textarea>
        </div>

        <div class="flex items-center justify-between text-xs text-gray-500">
          <span id="share-status"></span>
          <span>Posts are published via TikTok Content Posting API from the backend.</span>
        </div>

        <div class="flex justify-end gap-3 mt-4">
          <button
            type="button"
            class="px-4 py-2 rounded-lg border border-gray-300 text-gray-700 text-sm hover:bg-gray-100"
            onclick="closeShareModal()"
          >
            Cancel
          </button>
          <button
            type="submit"
            class="px-4 py-2 rounded-lg bg-black text-white text-sm font-medium hover:bg-gray-900 inline-flex items-center gap-2"
          >
            <img src="tiktok-logo.svg" alt="TikTok" class="w-4 h-4" />
            <span>Send to TikTok</span>
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- TikTok Integration Script -->
  <script>
    // ==========================
    // CONFIG – SAFE FOR FRONTEND
    // ==========================
    // Your TikTok client key (this is public, OK to be in frontend)
    const TIKTOK_CLIENT_KEY = "aw10n69ab8bug2zx";

    // This must match exactly what you configure in TikTok dev portal
    const REDIRECT_URI = "https://smartbuyguide.vercel.app/";

    // Scopes approved for your app (adjust as needed)
    const TIKTOK_SCOPE = "user.info.basic";

    // Backend endpoints (you implement on Vercel / other server)
    const BACKEND_EXCHANGE_URL = "/api/tiktok/exchange-code";
    const BACKEND_POST_URL = "/api/tiktok/post";

    function setAuthStatus(msg) {
      const el = document.getElementById("tiktok-auth-status");
      if (el) el.textContent = msg;
    }

    // ========== Login with TikTok ==========
    function loginWithTikTok() {
      if (!TIKTOK_CLIENT_KEY) {
        alert("TikTok client key is not configured.");
        return;
      }

      const state = crypto.randomUUID();
      sessionStorage.setItem("tiktok_state", state);

      const url = new URL("https://www.tiktok.com/v2/auth/authorize/");
      url.searchParams.set("client_key", TIKTOK_CLIENT_KEY);
      url.searchParams.set("response_type", "code");
      url.searchParams.set("scope", TIKTOK_SCOPE);
      url.searchParams.set("redirect_uri", REDIRECT_URI);
      url.searchParams.set("state", state);

      setAuthStatus("Redirecting to TikTok login…");
      window.location.href = url.toString();
    }

    // Handle redirect back from TikTok
    async function handleOAuthRedirect() {
      const params = new URLSearchParams(window.location.search);
      const code = params.get("code");
      const state = params.get("state");
      const error = params.get("error");

      if (error) {
        setAuthStatus("TikTok login failed: " + error);
        return;
      }

      if (!code) {
        setAuthStatus("Not logged in with TikTok.");
        return;
      }

      const storedState = sessionStorage.getItem("tiktok_state");
      if (storedState && state !== storedState) {
        setAuthStatus("TikTok login error: state mismatch.");
        return;
      }

      setAuthStatus("TikTok login successful – authorization code received.");
      const codeContainer = document.getElementById("tiktok-auth-code-container");
      const codeEl = document.getElementById("tiktok-auth-code");
      if (codeContainer && codeEl) {
        codeContainer.classList.remove("hidden");
        codeEl.textContent = code;
      }

      // OPTIONAL: notify backend to exchange code for access token
      try {
        const res = await fetch(BACKEND_EXCHANGE_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ code, redirect_uri: REDIRECT_URI })
        });
        if (res.ok) {
          const data = await res.json();
          console.log("Backend exchange result:", data);
          if (data && data.user && data.user.display_name) {
            setAuthStatus("Logged in as @" + data.user.display_name + " on TikTok.");
          }
        } else {
          console.warn("Backend exchange failed", await res.text());
        }
      } catch (e) {
        console.warn("Exchange code network error", e);
      }
    }

    // ========== Share / Post modal logic ==========
    function openShareModal(postMode = "DRAFT") {
      document.getElementById("post-mode").value = postMode;
      document.getElementById("share-modal-title").textContent =
        postMode === "DIRECT_POST" ? "Post Product Directly to TikTok" : "Share Product to TikTok";
      document.getElementById("share-status").textContent = "";
      const modal = document.getElementById("share-modal");
      modal.classList.remove("hidden");
      modal.classList.add("flex");
    }

    function closeShareModal() {
      const modal = document.getElementById("share-modal");
      modal.classList.add("hidden");
      modal.classList.remove("flex");
    }

    async function submitShareForm(event) {
      event.preventDefault();
      const productName = document.getElementById("product-name").value.trim();
      const mediaUrl = document.getElementById("media-url").value.trim();
      const caption = document.getElementById("caption").value.trim();
      const postMode = document.getElementById("post-mode").value;
      const statusEl = document.getElementById("share-status");

      if (!productName || !mediaUrl || !caption) return;

      statusEl.textContent = "Sending content to backend…";

      try {
        const res = await fetch(BACKEND_POST_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ productName, mediaUrl, caption, postMode })
        });

        if (!res.ok) {
          statusEl.textContent = "Error sending content to backend.";
          console.error("Backend post error", await res.text());
          return;
        }

        const data = await res.json();
        console.log("Backend post result:", data);
        statusEl.textContent = "Content sent to TikTok via backend. Check TikTok app for the post.";
      } catch (e) {
        console.error("Post to TikTok error", e);
        statusEl.textContent = "Network error sending content to backend.";
      }
    }

    window.addEventListener("DOMContentLoaded", () => {
      handleOAuthRedirect();
    });
  </script>
</body>
</html>
